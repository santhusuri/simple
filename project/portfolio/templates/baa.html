{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}My Site{% endblock %}</title>
    <link href="{% static 'css/base.css' %}" rel="stylesheet">
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const params = new URLSearchParams(window.location.search);
            if (params.get("show") === "login") {
                document.getElementById("signinModal").classList.remove("hidden");
            } else if (params.get("show") === "signup") {
                document.getElementById("signupModal").classList.remove("hidden");
            }
        });
    </script>
</head>
<body class="bg-gray-100">

    <header class="navbar">
    <a href="/" class="logo">Project Portal</a>

    <div class="nav-links">
        {% if user.is_authenticated %}
            <span class="welcome-text">Welcome, {{ user.username }}</span>
            <a href="{% url 'home' %}">Home</a>
            <a href="{% url 'about' %}">About</a>
            <a href="{% url 'projects' %}">Projects</a>
            <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
        {% else %}
            <button class="auth-btn" onclick="document.getElementById('signinModal').classList.remove('hidden')">Sign In</button>
            <button class="auth-btn" onclick="document.getElementById('signupModal').classList.remove('hidden')">Sign Up</button>
        {% endif %}
    </div>
</header>

    {% block content %}
    {% if user.is_authenticated %}
        <div class="container">
            <h2>Your Projects</h2>
            {% if user.project_set.all %}
                <ul>
                {% for project in user.project_set.all %}
                    <li>{{ project.title }} - {{ project.description }}</li>
                {% endfor %}
                </ul>
            {% else %}
                <p>No projects yet.</p>
            {% endif %}
        </div>
    {% endif %}
    {% endblock %}

    <!-- Sign In Modal -->
    <div id="signinModal" class="modal hidden">
        <div class="modal-content">
            <h2>Sign In</h2>
            <form method="POST" action="{% url 'signin' %}">
                {% csrf_token %}
                <input type="text" name="username" placeholder="Username" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Sign In</button>
            </form>
            <p class="small-link">
                New user? <a href="#" onclick="switchModal('signinModal','signupModal')">Register here</a>
            </p>
            <button class="close-btn" onclick="document.getElementById('signinModal').classList.add('hidden')">Close</button>
        </div>
    </div>

    <!-- Sign Up Modal -->
    <div id="signupModal" class="modal hidden">
        <div class="modal-content">
            <h2>Sign Up</h2>
            <form method="POST" action="{% url 'signup' %}">
                {% csrf_token %}
                <input type="text" name="username" placeholder="Username" required>
                <input type="email" name="email" placeholder="Email" required>
                <input type="password" name="password1" placeholder="Password" required>
                <input type="password" name="password2" placeholder="Confirm Password" required>
                <button type="submit">Sign Up</button>
            </form>
            <p class="small-link">
                Already have an account? <a href="#" onclick="switchModal('signupModal','signinModal')">Login here</a>
            </p>
            <button class="close-btn" onclick="document.getElementById('signupModal').classList.add('hidden')">Close</button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <nav>
            <a href="{% url 'home' %}">Home</a>
            <a href="{% url 'about' %}">About</a>
            <a href="{% url 'projects' %}">Projects</a>
            <a href="{% url 'contact' %}">Contact</a>
        </nav>
        <p>&copy; 2025 My Portfolio. All rights reserved.</p>
    </footer>

    <script>
        function switchModal(hideId, showId) {
            document.getElementById(hideId).classList.add('hidden');
            document.getElementById(showId).classList.remove('hidden');
        }
    </script>

</body>
</html>
